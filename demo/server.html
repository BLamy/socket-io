<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <title>Electron polymer koa</title>
  <script src="bower_components/webcomponentsjs/webcomponents-lite.js"></script>
  <link rel="import" href="bower_components/koa-server/koa-server.html">
  <link rel="import" href="bower_components/koa-route/koa-route.html">
</head>

<body>
  <template id="app" is="dom-bind">
    <koa-server port="{{port}}">
      <koa-route method="get" path="/" middleware="[[_home()]]"></koa-route>
      <koa-use middleware="[[_staticCache()]]"></koa-use>
    </koa-server>
    <h1>Koa Server running on port: [[port]]</h1>
  </template>
  <script>
  (function(fs, mount, serve) {
    'use strict';
    var scope = document.querySelector('template[is="dom-bind"]');

    scope._home = () => {
      return function*() {
        this.type = 'text/html';
        this.body = yield fs.readFile('index.html');
      };
    };

    app._staticCache = () => {
      return mount('/static', serve(__dirname + '/static'));
    };

  })(require('co-fs'), require('koa-mount'), require('koa-static'));
  </script>
</body>

</html>
